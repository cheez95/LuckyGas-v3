# Redis Sentinel Configuration for Lucky Gas
# Provides automatic failover and monitoring

# Port on which Sentinel should run
port 26379

# Bind to all interfaces
bind 0.0.0.0

# Sentinel working directory
dir /tmp

# Sentinel log file
logfile ""

# Master monitoring configuration
# sentinel monitor <master-name> <ip> <redis-port> <quorum>
sentinel monitor luckygas-master redis-master 6379 2

# Authentication for master
# Note: Password will be set via environment variable in docker-compose
# sentinel auth-pass luckygas-master ${REDIS_PASSWORD}

# Down-after-milliseconds
# Master is considered down after this time (milliseconds)
sentinel down-after-milliseconds luckygas-master 5000

# Parallel syncs
# How many replicas can be reconfigured to use the new master simultaneously
sentinel parallel-syncs luckygas-master 1

# Failover timeout
# Timeout for the entire failover process
sentinel failover-timeout luckygas-master 10000

# Notification scripts (optional)
# sentinel notification-script luckygas-master /var/redis/notify.sh
# sentinel client-reconfig-script luckygas-master /var/redis/reconfig.sh

# Deny commands during failover
sentinel deny-scripts-reconfig yes

# Announce Sentinel
sentinel announce-ip ""
sentinel announce-port 0

# Enable protected mode
protected-mode no

# Set Sentinel ID (auto-generated if not set)
# sentinel myid 

# Sentinel persistence
sentinel announce-hostnames no
sentinel resolve-hostnames no

# Connection settings
tcp-backlog 511
tcp-keepalive 60
timeout 0

# Logging
loglevel notice
syslog-enabled no

# Client output buffer limits
client-output-buffer-limit normal 0 0 0
client-output-buffer-limit replica 256mb 64mb 60
client-output-buffer-limit pubsub 32mb 8mb 60

# Advanced failover settings
sentinel notification-script luckygas-master /scripts/notify.sh
sentinel client-reconfig-script luckygas-master /scripts/reconfig.sh

# Sentinel authentication (if using ACL)
# requirepass sentinel_password
# sentinel sentinel-pass other_sentinel_password

# Lucky Gas specific settings
# Monitor additional masters if needed
# sentinel monitor cache-master redis-cache-master 6379 2
# sentinel down-after-milliseconds cache-master 5000
# sentinel parallel-syncs cache-master 1
# sentinel failover-timeout cache-master 10000